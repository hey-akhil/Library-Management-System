<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Library Books</title>
    <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"/>
    <link rel="stylesheet" href="static/book_list.css">
</head>
<body>
    {% include 'navbar.html' %}

    <main>
      <h2>Library Books</h2>
      <table>
          <thead>
            <tr>
                <th>ID</th>
                <th>Title</th>
                <th>Author</th>
                <th>Published Year</th>
                <th>Copies Available</th>
                <th>Action</th>
            </tr>
          </thead>
          <tbody>
          {% for book in books %}
            <tr>
                <td>{{ book["id"] }}</td>
                <td>{{ book["title"] }}</td>
                <td>{{ book["author"] }}</td>
                <td>{{ book["published_year"] }}</td>
                <td>{{ book["copies_available"] }}</td>
                <td>
                  {% if user %}
                    {% if book["id"] in issued_book_ids %}
                      <!-- Return button -->
                      <form method="post" action="/return-book" style="margin:0; display:inline;">
                        <input type="hidden" name="book_id" value="{{ book['id'] }}">
                        <button type="submit" class="issue-button return">Return</button>
                      </form>
                    {% elif book["copies_available"] > 0 %}
                      <!-- Issue button -->
                      <form method="post" action="/issue-book" style="margin:0;">
                        <input type="hidden" name="book_id" value="{{ book['id'] }}">
                        <button type="submit" class="issue-button">Issue</button>
                      </form>
                    {% else %}
                      <span class="status-text">Unavailable</span>
                    {% endif %}
                  {% else %}
                    <span class="status-text">Login to issue</span>
                  {% endif %}
                </td>
            </tr>
          {% else %}
            <tr>
                <td colspan="6" style="text-align: center; color: #999;">No books available</td>
            </tr>
          {% endfor %}
          </tbody>
      </table>
    </main>
</body>
</html>
